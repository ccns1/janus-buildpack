#!/bin/bash

indent() {
  sed -u 's/^/       /'
}

echo "-----> Starting Janus install.."

#ln -s /usr/include/libv4l1-videodev.h /usr/include/linux/videodev.h

cd $1

while read url; do
  cd $1
  echo "-----> Fetching $url..."
  [ ! -d $(grep -oP "[^/]*(?=\.tar)" <<< $url) ] && curl -s $url | tar xz
  cd $(grep -oP "[^/]*(?=\.tar)" <<< $url)
  echo "-----> Configure $(grep -oP "[^/]*(?=\.tar)" <<< $url)..."
  ./configure --prefix=/usr/local
  echo "-----> Make $(grep -oP "[^/]*(?=\.tar)" <<< $url)..."
  make
  make install
  echo "-----> Make $(grep -oP "[^/]*(?=\.tar)" <<< $url) Complete."
done < .janustars

cd $1
yasm --version
find / -name yasm
cd yasm-1.3.0
yasm --version
echo $PATH
echo $LD_LIBRARY_PATH

echo "-----> Janus install complete"